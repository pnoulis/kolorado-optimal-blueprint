FROM --platform=linux/amd64 node:lts-jod
RUN apt-get update && apt-get upgrade -y \
    && apt-get install make
WORKDIR /srv
ARG MODE=production
ENV URL=http://localhost
ENV PORT=3000
ENV SERVER_URL=http://localhost:8080
COPY . .
RUN configure --mode=$MODE \
    --url="$URL" \
    --port="$PORT" \
    --server-url="$SERVER_URL"
RUN npm install --loglevel verbose
